<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="ุฏููู ุงูุณุงุฆู ููููุงุทู ุฐุงุช ุงูุทูุจ ุงูุนุงูู ูู ุนูุงู - ุชุทุจูู ููุณุงุนุฏุฉ ุงูุณุงุฆููู ุนูู ุฅูุฌุงุฏ ุงูููุงุทู ุฐุงุช ุงูุทูุจ ุงูุนุงูู">
    <meta name="theme-color" content="#4361ee">
    <title>ุฏููู ุงูุณุงุฆู ููููุงุทู ุฐุงุช ุงูุทูุจ ุงูุนุงูู - ุนูุงู</title>
    <link rel="stylesheet" href="https://unpkg.com/maplibre-gl@4.0.2/dist/maplibre-gl.css" />
    <link rel="stylesheet" href="style.css" />
</head>
<body>
    <div class="driver-container">
        <!-- Driver-Optimized Header -->
        <header class="driver-header">
            <div class="header-main">
                <h1>๐ ุฏููู ุงูุณุงุฆู</h1>
                <div class="voice-controls">
                    <button id="voice-toggle" class="voice-btn" aria-label="ุชูุนูู/ุฅููุงู ุงูุตูุช">
                        ๐
                    </button>
                    <button id="share-location" class="share-btn" aria-label="ูุดุงุฑูุฉ ุงููููุน">
                        ๐ค
                    </button>
                    <button id="emergency-btn" class="emergency-btn" aria-label="ุทูุงุฑุฆ">
                        ๐จ
                    </button>
                </div>
                <div class="view-controls">
                    <button id="view-toggle" class="view-toggle-btn" aria-label="ุชุจุฏูู ุนุฑุถ ุงูุฎุฑูุทุฉ">
                        ๐บ๏ธ
                    </button>
                </div>
            </div>
            <div class="status-bar">
                <div class="status-item">
                    <span class="status-icon">๐</span>
                    <span id="current-area-display" class="status-text">ุฌุงุฑู ุงูุชุญุฏูุฏ...</span>
                </div>
                <div class="status-item">
                    <span class="status-icon">โฐ</span>
                    <span id="demand-mode-display" class="status-text">ุฌุงุฑู ุงูุชุญููู...</span>
                </div>
            </div>
        </header>

        <!-- Driver Dashboard -->
        <div class="driver-dashboard">
            <!-- Location Display Mode -->
            <div class="location-display-card" id="location-display-card">
                <div class="location-main">
                    <div class="location-icon">๐</div>
                    <div class="location-info">
                        <div class="current-location-name" id="current-location-name">ุฌุงุฑู ุชุญุฏูุฏ ุงููููุน...</div>
                        <div class="location-details" id="location-details">
                            <span class="accuracy-info" id="accuracy-info">--</span>
                            <span class="speed-info" id="speed-info">--</span>
                        </div>
                    </div>
                </div>
                <div class="next-direction" id="next-direction">
                    <div class="direction-icon" id="direction-icon">โก๏ธ</div>
                    <div class="direction-text" id="direction-text">ุงุณุชูุฑ ูู ุงูุทุฑูู ุงูุญุงูู</div>
                </div>
            </div>
            <!-- Primary Action Card -->
            <div class="action-card primary-card">
                <div class="card-header">
                    <h2>๐ฏ ุงูููุทูุฉ ุงูููุชุฑุญุฉ</h2>
                    <div class="demand-indicator" id="demand-indicator">
                        <span class="demand-level" id="demand-level">--</span>
                    </div>
                </div>
                <div class="card-content">
                    <div class="suggested-zone" id="suggested-zone-display">ุฌุงุฑู ุงูุจุญุซ...</div>
                    <div class="zone-details" id="zone-details">
                        <span class="distance" id="suggested-distance">--</span>
                        <span class="eta" id="suggested-eta">--</span>
                    </div>
                </div>
                <div class="card-actions">
                    <button id="navigate-btn" class="action-btn primary-btn" disabled>
                        ๐งญ ุชูุฌู ุงูุขู
                    </button>
                    <button id="refresh-suggestion" class="action-btn secondary-btn">
                        ๐ ุชุญุฏูุซ
                    </button>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="quick-actions">
                <button id="find-nearest" class="quick-btn">
                    <span class="btn-icon">๐</span>
                    <span class="btn-text">ุฃูุฑุจ ููุทูุฉ</span>
                </button>
                <button id="high-demand-filter" class="quick-btn toggle-btn">
                    <span class="btn-icon">๐ฅ</span>
                    <span class="btn-text">ุทูุจ ุนุงูู ููุท</span>
                </button>
                <button id="voice-navigation" class="quick-btn">
                    <span class="btn-icon">๐ค</span>
                    <span class="btn-text">ุงูุชูุฌูู ุงูุตูุชู</span>
                </button>
                <button id="safety-mode" class="quick-btn toggle-btn">
                    <span class="btn-icon">๐ก๏ธ</span>
                    <span class="btn-text">ูุถุน ุงูุฃูุงู</span>
                </button>
            </div>
        </div>

        <!-- Map Container -->
        <div id="map" class="driver-map" aria-label="ุฎุฑูุทุฉ ุงูููุงุทู" role="application"></div>

        <!-- Bottom Panel -->
        <div class="bottom-panel">
            <div class="panel-tabs">
                <button class="tab-btn active" data-tab="zones">ุงูููุงุทู</button>
                <button class="tab-btn" data-tab="settings">ุงูุฅุนุฏุงุฏุงุช</button>
                <button class="tab-btn" data-tab="debug">ุงูุชุดุฎูุต</button>
            </div>

            <!-- Zones Tab -->
            <div class="tab-content active" id="zones-tab">
                <div class="zones-header">
                    <h3>ุงูููุงุทู ุงููุชุงุญุฉ</h3>
                    <div class="zones-filter">
                        <select id="zone-sort" class="filter-select">
                            <option value="demand">ุญุณุจ ุงูุทูุจ</option>
                            <option value="distance">ุญุณุจ ุงููุณุงูุฉ</option>
                            <option value="name">ุญุณุจ ุงูุงุณู</option>
                        </select>
                    </div>
                </div>
                <!-- ุฅุถุงูุฉ ุญุงูู ูุญุณู ููุณูุฑููููู -->
                <div class="zones-grid-wrapper">
                    <div id="zones-grid" class="zones-grid scrollable-content" aria-label="ูุงุฆูุฉ ุงูููุงุทู"></div>
                </div>
            </div>

            <!-- Settings Tab -->
            <div class="tab-content" id="settings-tab">
                <div class="settings-section">
                    <h3>ุฅุนุฏุงุฏุงุช ุงูุตูุช</h3>
                    <div class="setting-item">
                        <label for="voice-enabled">ุชูุนูู ุงูุชูุจููุงุช ุงูุตูุชูุฉ</label>
                        <input type="checkbox" id="voice-enabled" checked>
                    </div>
                    <div class="setting-item">
                        <label for="voice-volume">ูุณุชูู ุงูุตูุช</label>
                        <input type="range" id="voice-volume" min="0" max="100" value="70">
                    </div>
                    <div class="setting-item">
                        <label for="voice-language">ูุบุฉ ุงูุชูุจููุงุช</label>
                        <select id="voice-language">
                            <option value="ar">ุงูุนุฑุจูุฉ</option>
                            <option value="en">English</option>
                        </select>
                    </div>
                </div>
                
                <div class="settings-section">
                    <h3>ุฅุนุฏุงุฏุงุช ุงูููุงุฏุฉ</h3>
                    <div class="setting-item">
                        <label for="safety-mode-setting">ูุถุน ุงูุฃูุงู</label>
                        <input type="checkbox" id="safety-mode-setting">
                    </div>
                    <div class="setting-item">
                        <label for="auto-refresh">ุงูุชุญุฏูุซ ุงูุชููุงุฆู</label>
                        <input type="checkbox" id="auto-refresh" checked>
                    </div>
                    <div class="setting-item">
                        <label for="map-style-setting">ููุท ุงูุฎุฑูุทุฉ</label>
                        <select id="map-style-setting">
                            <option value="osm">ุนุงุฏู</option>
                            <option value="satellite">ููุฑ ุตูุงุนู</option>
                            <option value="dark">ุฏุงูู</option>
                        </select>
                    </div>
                </div>

                <div class="settings-section">
                    <h3>ุฅุนุฏุงุฏุงุช ุงูุนุฑุถ</h3>
                    <div class="setting-item">
                        <label for="auto-switch-text">ุงูุชุจุฏูู ุงูุชููุงุฆู ูููุต ุฃุซูุงุก ุงูููุงุฏุฉ</label>
                        <input type="checkbox" id="auto-switch-text">
                    </div>
                    <div class="setting-item">
                        <label for="text-mode-speed">ุณุฑุนุฉ ุงูุชุจุฏูู ุงูุชููุงุฆู (ูู/ุณ)</label>
                        <input type="range" id="text-mode-speed" min="20" max="60" value="30">
                        <span id="speed-display">30</span>
                    </div>
                    <div class="setting-item">
                        <label for="enhanced-voice-text">ุชุนูููุงุช ุตูุชูุฉ ูุญุณูุฉ ูู ูุถุน ุงููุต</label>
                        <input type="checkbox" id="enhanced-voice-text" checked>
                    </div>
                </div>
            </div>

            <!-- Debug Tab -->
            <div class="tab-content" id="debug-tab">
                <div class="debug-section">
                    <h3>ูุนูููุงุช ุงููุธุงู</h3>
                    <div class="debug-grid">
                        <div class="debug-item">
                            <span class="debug-label">ุญุงูุฉ ุงูุชุทุจูู:</span>
                            <span id="app-state" class="debug-value">ุชููุฆุฉ</span>
                        </div>
                        <div class="debug-item">
                            <span class="debug-label">ุญุงูุฉ ุงููููุน:</span>
                            <span id="location-state" class="debug-value">ุบูุฑ ูุญุฏุฏ</span>
                        </div>
                        <div class="debug-item">
                            <span class="debug-label">ุฏูุฉ ุงููููุน:</span>
                            <span id="location-accuracy" class="debug-value">--</span>
                        </div>
                        <div class="debug-item">
                            <span class="debug-label">ุนุฏุฏ ุงูููุงุทู:</span>
                            <span id="zones-count" class="debug-value">--</span>
                        </div>
                    </div>
                    <div class="debug-actions">
                        <button id="test-voice" class="debug-btn">ุงุฎุชุจุงุฑ ุงูุตูุช</button>
                        <button id="force-reload" class="debug-btn">ุฅุนุงุฏุฉ ุชุญููู</button>
                        <button id="export-logs" class="debug-btn">ุชุตุฏูุฑ ุงูุณุฌูุงุช</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Audio Elements -->
        <audio id="notification-sound" preload="auto">
            <source src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBSuBzvLZiTYIG2m98OScTgwOUarm7blmGgU7k9n1unEiBC13yO/eizEIHWq+8+OWT" type="audio/wav">
        </audio>

        <!-- Voice Alerts Container -->
        <div id="voice-alerts" class="voice-alerts" aria-live="polite"></div>

        <!-- Loading Overlay -->
        <div id="loading-overlay" class="loading-overlay" style="display: flex;">
            <div class="loading-content">
                <div class="loading-spinner"></div>
                <div class="loading-text">ุฌุงุฑู ุชุญููู ุงูุชุทุจูู...</div>
                <div style="margin-top: 1rem; font-size: 0.9rem; color: var(--text-secondary);">
                    ูุฑุฌู ุงูุงูุชุธุงุฑ...
                </div>
            </div>
        </div>

        <!-- Toast Notifications -->
        <div id="toast" class="toast" role="alert" aria-live="assertive"></div>

        <!-- Share Location Modal -->
        <div id="share-modal" class="share-modal">
            <div class="share-modal-content">
                <div class="share-header">
                    <h3>ูุดุงุฑูุฉ ุงููููุน</h3>
                    <button id="close-share-modal" class="close-btn">โ</button>
                </div>
                
                <div class="share-tabs">
                    <button class="share-tab-btn active" data-tab="quick">ูุดุงุฑูุฉ ุณุฑูุนุฉ</button>
                    <button class="share-tab-btn" data-tab="contacts">ุฌูุงุช ุงูุงุชุตุงู</button>
                    <button class="share-tab-btn" data-tab="live">ุชุชุจุน ูุจุงุดุฑ</button>
                </div>

                <!-- Quick Share Tab -->
                <div class="share-tab-content active" id="quick-share-tab">
                    <div class="location-preview">
                        <div class="preview-icon">๐</div>
                        <div class="preview-info">
                            <div class="preview-title" id="share-location-name">ุงููููุน ุงูุญุงูู</div>
                            <div class="preview-details" id="share-location-details">ุฌุงุฑู ุชุญุฏูุฏ ุงููููุน...</div>
                        </div>
                    </div>
                    
                    <div class="share-options">
                        <button id="share-whatsapp" class="share-option-btn whatsapp">
                            <span class="share-icon">๐ฌ</span>
                            <span class="share-text">WhatsApp</span>
                        </button>
                        <button id="share-telegram" class="share-option-btn telegram">
                            <span class="share-icon">โ๏ธ</span>
                            <span class="share-text">Telegram</span>
                        </button>
                        <button id="share-sms" class="share-option-btn sms">
                            <span class="share-icon">๐ฌ</span>
                            <span class="share-text">ุฑุณุงูุฉ ูุตูุฉ</span>
                        </button>
                        <button id="share-copy" class="share-option-btn copy">
                            <span class="share-icon">๐</span>
                            <span class="share-text">ูุณุฎ ุงูุฑุงุจุท</span>
                        </button>
                        <button id="share-email" class="share-option-btn email">
                            <span class="share-icon">๐ง</span>
                            <span class="share-text">ุจุฑูุฏ ุฅููุชุฑููู</span>
                        </button>
                        <button id="share-maps" class="share-option-btn maps">
                            <span class="share-icon">๐บ๏ธ</span>
                            <span class="share-text">ุฎุฑุงุฆุท ุฌูุฌู</span>
                        </button>
                    </div>
                </div>

                <!-- Contacts Tab -->
                <div class="share-tab-content" id="contacts-share-tab">
                    <div class="contacts-header">
                        <input type="text" id="contact-search" placeholder="ุงูุจุญุซ ูู ุฌูุงุช ุงูุงุชุตุงู..." class="contact-search">
                        <button id="add-contact" class="add-contact-btn">+ ุฅุถุงูุฉ ุฌูุฉ ุงุชุตุงู</button>
                    </div>
                    <!-- ุฅุถุงูุฉ ุญุงูู ูุญุณู ููุณูุฑููููู -->
                    <div class="contacts-wrapper">
                        <div id="favorite-contacts" class="favorite-contacts scrollable-content"></div>
                    </div>
                </div>

                <!-- Live Tracking Tab -->
                <div class="share-tab-content" id="live-share-tab">
                    <div class="live-tracking-info">
                        <div class="live-icon">๐ก</div>
                        <h4>ุงูุชุชุจุน ุงููุจุงุดุฑ</h4>
                        <p>ูุดุงุฑูุฉ ูููุนู ุงููุจุงุดุฑ ูุน ุงูุขุฎุฑูู ููุชุฑุฉ ูุญุฏุฏุฉ</p>
                    </div>
                    
                    <div class="live-options">
                        <div class="duration-selector">
                            <label>ูุฏุฉ ุงููุดุงุฑูุฉ:</label>
                            <select id="share-duration">
                                <option value="15">15 ุฏูููุฉ</option>
                                <option value="30" selected>30 ุฏูููุฉ</option>
                                <option value="60">ุณุงุนุฉ ูุงุญุฏุฉ</option>
                                <option value="120">ุณุงุนุชุงู</option>
                                <option value="480">8 ุณุงุนุงุช</option>
                            </select>
                        </div>
                        
                        <div class="privacy-options">
                            <label>
                                <input type="checkbox" id="include-destination" checked>
                                ุชุถููู ุงููุฌูุฉ ุงูููุชุฑุญุฉ
                            </label>
                            <label>
                                <input type="checkbox" id="show-route">
                                ุนุฑุถ ุงููุณุงุฑ ุงููุชุจุน
                            </label>
                        </div>
                        
                        <button id="start-live-share" class="start-live-btn">ุจุฏุก ุงููุดุงุฑูุฉ ุงููุจุงุดุฑุฉ</button>
                    </div>
                    
                    <div id="active-shares" class="active-shares"></div>
                </div>
            </div>
        </div>

        <!-- Add Contact Modal -->
        <div id="add-contact-modal" class="add-contact-modal">
            <div class="add-contact-content">
                <div class="add-contact-header">
                    <h3>ุฅุถุงูุฉ ุฌูุฉ ุงุชุตุงู</h3>
                    <button id="close-add-contact" class="close-btn">โ</button>
                </div>
                <form id="add-contact-form">
                    <div class="form-group">
                        <label for="contact-name">ุงูุงุณู:</label>
                        <input type="text" id="contact-name" required>
                    </div>
                    <div class="form-group">
                        <label for="contact-phone">ุฑูู ุงููุงุชู:</label>
                        <input type="tel" id="contact-phone" required>
                    </div>
                    <div class="form-group">
                        <label for="contact-type">ุงูููุน:</label>
                        <select id="contact-type">
                            <option value="customer">ุนููู</option>
                            <option value="family">ุนุงุฆูุฉ</option>
                            <option value="friend">ุตุฏูู</option>
                            <option value="work">ุนูู</option>
                        </select>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="save-contact-btn">ุญูุธ</button>
                        <button type="button" id="cancel-add-contact" class="cancel-btn">ุฅูุบุงุก</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/maplibre-gl@4.0.2/dist/maplibre-gl.js"></script>
    <script src="app.js"></script>
</body>
</html>
